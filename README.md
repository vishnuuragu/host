# Dealroom to Airtable Integration

## Overview

This project automates the process of fetching transactions related to the sports industry from the Dealroom API, saving the data locally, and uploading the relevant company data to Airtable. The system is scheduled to run at specified intervals using cron jobs, with options for executing the process every minute, daily, or weekly.

## Prerequisites

- **Node.js** (v12 or higher)
- **npm** (v6 or higher)
- **Airtable Account** with an API key
- **Dealroom API Key**

## Project Structure

- **`dealroom.js`**: Fetches transactions from the Dealroom API and saves the response data to a JSON file. It also updates the max date after each successful run to ensure only new transactions are fetched.
- **`airtable.js`**: Reads the response JSON file generated by `dealroom.js` and uploads the relevant company data to Airtable.
- **`main.js`**: A cron job scheduler that runs the `dealroom.js` and `airtable.js` scripts at specified intervals.
- **`response.json`**: Stores the fetched transaction data from the Dealroom API.
- **`date.json`**: Stores the latest max date to track the last fetched transactions.
- **`.env`**: Stores sensitive API keys and configuration variables.

## Installation

1. Clone the repository:
    ```bash
    git clone <repository-url>
    cd <repository-folder>
    ```

2. Install the necessary packages:
    ```bash
    npm install
    ```

3. Create a `.env` file in the root directory and add the following environment variables:
    ```bash
    DEALROOM_API_KEY=your_dealroom_api_key
    AIRTABLE_API_KEY=your_airtable_api_key
    BASE_ID=your_airtable_base_id
    TABLE_NAME=your_airtable_table_name
    ```

## Usage

### Running the Project Manually

1. To fetch data from Dealroom:
    ```bash
    node dealroom.js
    ```

2. To upload the fetched data to Airtable:
    ```bash
    node airtable.js
    ```

### Running the Project Automatically

- The `main.js` script is set up to run the data fetching and uploading processes on a schedule using `node-cron`.
- By default, the script runs every 1 minute. You can modify the schedule in `main.js` to run daily or weekly by uncommenting the relevant lines:

    - For daily execution at midnight:
        ```javascript
        cron.schedule('0 0 * * *', () => {
            shell.exec('node dealroom.js');
            shell.exec('node airtable.js');
        });
        ```

    - For weekly execution at midnight on Sundays:
        ```javascript
        cron.schedule('0 0 * * 0', () => {
            shell.exec('node dealroom.js');
            shell.exec('node airtable.js');
        });
        ```

### Logging

- All actions are logged using `winston` and can be found in the `app.log` file in the root directory.

### Error Handling

- Errors encountered during API requests or file operations are logged in the `app.log` file.

